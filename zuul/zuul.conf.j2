# This file is generated by Ansible
#  DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
#
{% if inventory_hostname in groups['zuul-scheduler'] or inventory_hostname in groups['zuul-web'] %}
[zookeeper]
hosts = {{ groups['zookeeper'] | map('extract', hostvars, ['ansible_host']) | join(':2181,') }}:2181

{% endif -%}

[gearman]
port = 4730
server = {{ hostvars[groups['gear'][0]].ansible_host }}
ssl_ca = {{ zuul_file_gearman_ssl_ca_dest }}
ssl_cert = {{ zuul_file_gearman_ssl_cert_dest }}
ssl_key = {{ zuul_file_gearman_ssl_key_dest }}

{% if groups['statsd'] | list and ansible_host | ipv4 %}
[statsd]
server = {{ hostvars[groups['statsd'][0]].ansible_host }}

{% endif -%}

{% if inventory_hostname in groups['zuul-scheduler'] %}
[gearman_server]
start = False

[scheduler]
tenant_config = {{ zuul_file_main_yaml_dest }}
log_config = /etc/zuul/scheduler-logging.conf
pidfile = /var/run/zuul-scheduler/zuul-scheduler.pid
relative_priority = true
state_dir = {{ zuul_user_home }}
relative_priority = True

{% endif -%}

{% if inventory_hostname in groups['zuul-executor'] %}
[executor]
ansible_root = /var/lib/zuul/venv/ansible
disk_limit_per_job = 1024
log_config = /etc/zuul/executor-logging.conf
manage_ansible = false
private_key_file = {{ zuul_user_home }}/.ssh/nodepool_id_rsa
trusted_ro_paths = /opt/venv/zuul-ansible
untrusted_ro_paths = /opt/venv/zuul-ansible
workspace_root = {{ zuul_user_home }}/workspace

{% endif -%}

{% if inventory_hostname in groups['zuul-fingergw'] %}
[fingergw]
listen_address = {{ hostvars[groups['zuul-fingergw'][0]].ansible_host }}
log_config = /etc/zuul/fingergw-logging.conf
user = {{ zuul_user_name }}

{% endif -%}

{% if inventory_hostname in groups['zuul-merger'] or inventory_hostname in groups['zuul-executor'] %}
[merger]
{% if inventory_hostname in groups['zuul-merger'] %}
git_dir = {{ zuul_user_home }}/git
log_config = /etc/zuul/merger-logging.conf
pidfile = /var/run/zuul-merger/zuul-merger.pid
{% endif %}
git_user_email = windmill@example.org
git_user_name = windmill

{% endif -%}

{% if inventory_hostname in groups['zuul-scheduler'] or inventory_hostname in groups['zuul-web'] %}
[web]
log_config = /etc/zuul/web-logging.conf
listen_address = 127.0.0.1
root = https://dashboard.zuul.ansible.com

[connection mysql]
driver = sql
dburi = mysql+pymysql://{{ __zuul_zuul_conf_connection_mysql_username_and_password }}@{{ hostvars[groups['database'][0]].ansible_host }}/zuul
{% endif %}

[connection github.com]
driver = github
app_id = {{ __zuul_conf_connection_github_app_id }}
app_key = {{ zuul_user_home }}/.ssh/github_id_rsa
webhook_token = {{ __zuul_conf_connection_github_webhook_token }}

[connection github-3pci]
canonical_hostname = github.com
driver = github
app_id = {{ __zuul_conf_connection_github_3pci_app_id }}
app_key = {{ zuul_user_home }}/.ssh/github_3pci_id_rsa
webhook_token = {{ __zuul_conf_connection_github_3pci_webhook_token }}

[connection opendev.org]
canonical_hostname = opendev.org
driver = gerrit
password = {{ __zuul_conf_connection_opendev_password }}
server = review.opendev.org
sshkey = {{ zuul_user_home }}/.ssh/gerrit_id_rsa
user = CaptPants
